<!-- <div class="page-breadcrumb page-header">
  <div class="row">
    <div class="col-12 align-self-center">
      <h4 class="page-title">Purchase Order</h4> -->
      <!-- <div class="d-flex align-items-center m-t-10">
                <span class="m-r-20">Start Date : {{startDate | date}} </span>
                <span>End Date : {{endDate | date}} </span>
            </div> -->
    <!-- </div>
  </div>
</div> -->
<div class="material-tab">
  <mat-tab-group [backgroundColor]="'primary'" animationDuration="0ms" [(selectedIndex)]="demo1TabIndex">
    <mat-tab>
      <ng-template mat-tab-label> Purchase Order </ng-template>
      <ng-template matTabContent>
        <mat-card>
          <mat-card-content>
            <form #myform="ngForm" (ngSubmit)="savefinaldata(myform)">
              <div class="row">
                <div class="col-md-2">
                  <label>Date<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="date" style="text-transform: uppercase" class="inputstyles" name="dateee"
                    [(ngModel)]="model1.dateee" dateFormat="yyyy/mm/dd" />
                </div>
                <!-- <div class="col-md-2">
                                    <label>Work Order Number</label>
                                </div>
                                <div class="col-md-4">
                                    <input type="text" class="inputstyles" name="wonumber"
                                        [(ngModel)]="model1.wonumber">
                                </div> -->
                <div class="col-md-2">
                  <label>Company Name<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <select class="dropdownstyles" name="companyname" [(ngModel)]="model1.companyname"
                    (change)="selectedcompany()">
                    <option [value]="undefined" selected disabled>Select One</option>
                    <option *ngFor="let item of companyData" [ngValue]="item.company_name">
                      {{ item.company_name }}
                    </option>
                  </select>
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-md-2">
                  <label>Transit Insurance<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <!-- <select class="dropdownstyles" name="fromcompany" [(ngModel)]="model1.fromcompany">
                                        <option selected disabled>Select One</option>
                                        <option *ngFor="let item of companyData" [ngValue]="item.name">{{item.name}}
                                        </option>
                                    </select> -->
                  <input type="text" placeholder="Enter Transit Insurance" class="inputstyles" name="tinsurance"
                    [(ngModel)]="model1.tinsurance" />
                </div>
                <div class="col-md-2">
                  <label>Packing Forwarding<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Packing Forwarding" class="inputstyles" name="packingforward"
                    [(ngModel)]="model1.packingforward" />
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-md-2">
                  <label>Vendor Name<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <!-- <select class="dropdownstyles" name="vendorname" [(ngModel)]="model1.vendorname">
                    <option selected disabled>Select One</option>
                    <option *ngFor="let item of vendorData" [ngValue]="item.name">{{item.name}}
                    </option>
                  </select> -->
                  <mat-form-field class="example-full-width "  appearance="none" class="matformfieldstyles">
                    <input type="text" placeholder="Search Gate Entry Number " aria-label="Number"
                                                            matInput style="border:none" class="inputdropdown1"name="vendorname" [(ngModel)]="model1.vendorname"
                                                             (keyup)="getvendordropdowndata($event)" [matAutocomplete]="auto9" />
                                                        <!-- (keyup)="checkPin($event)"  -->
                                                        <mat-autocomplete autoActiveFirstOption #auto9="matAutocomplete">
                
                                                            <mat-option *ngFor="let item of vendorData"
                                                                [value]="item.name" multiple>{{item.name}}
                                                            </mat-option>
                                                        </mat-autocomplete>
                                                    </mat-form-field>
                </div>
                <div class="col-md-2">
                  <label>Quantity Tolerance %<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" class="inputstyles" name="qtytolerance" (keypress)="keyPressNumbers($event)"
                    [(ngModel)]="model1.qtytolerance" placeholder="Enter Quantity Tolerance" />
                </div>
              </div>
              <br />
              <div class="row" style="margin-top: -29px;">
                <div class="col-md-2">
                  <label>Delivery Time<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Delivery Time" class="inputstyles" name="deltime"
                    [(ngModel)]="model1.deltime" />
                </div>
                <div class="col-md-2">
                  <label>Subject<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" class="inputstyles" placeholder="Enter Subject" name="subject"
                    [(ngModel)]="model1.subject" />
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-md-2">
                  <label>Shipping Address<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <!-- <select class="dropdownstyles" name="returntype" [(ngModel)]="model1.returntype">
                                        <option selected disabled >Select One</option>
                                        <option > Type1 </option>
                                        <option > Type2 </option>
                                    </select> -->
                  <input type="text" placeholder="Enter Shipping Address" class="inputstyles" name="shippingadd"
                    [(ngModel)]="model1.shippingadd" />
                </div>
                <div class="col-md-2">
                  <label>Vendor Reference<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Vendor Reference" class="inputstyles" name="vendorref"
                    [(ngModel)]="model1.vendorref" />
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-md-2">
                  <label>Billing Address<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Billing Address" class="inputstyles" name="billingadd"
                    [(ngModel)]="model1.billingadd" />
                </div>
                <div class="col-md-2">
                  <label>Payment Terms<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Payment Terms" class="inputstyles" name="paymentterms"
                    [(ngModel)]="model1.paymentterms" />
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-md-2">
                  <label>Other Tax Description<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Other Tax Description" class="inputstyles" name="otaxdesc"
                    [(ngModel)]="model1.otaxdesc" />
                </div>
                <div class="col-md-2">
                  <label>Other Tax Percentage<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Other Tax Percentage" (keypress)="keyPressNumbers($event)"
                    class="inputstyles" name="otaxperc" [(ngModel)]="model1.otaxperc" />
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-md-2">
                  <label>Other Tax Value<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Other Tax Value" (keypress)="keyPressNumbers($event)"
                    class="inputstyles" name="otaxvalue" [(ngModel)]="model1.otaxvalue" />
                </div>
                <div class="col-md-2">
                  <label>Unloading Scope<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Unloading Scope" class="inputstyles" name="unloadingscope"
                    [(ngModel)]="model1.unloadingscope" />
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-md-2">
                  <label>Mode Of Payment<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Mode Of Payment" class="inputstyles" name="paymentmode"
                    [(ngModel)]="model1.paymentmode" />
                </div>
                <div class="col-md-2">
                  <label>Freight<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Freight" (keypress)="keyPressNumbers($event)"
                    class="inputstyles" name="freight" [(ngModel)]="model1.freight" />
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-md-2">
                  <label>Enclosures<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Enclosures" class="inputstyles" name="enclosers"
                    [(ngModel)]="model1.enclosers" />
                </div>
                <div class="col-md-2">
                  <label>Price Basis<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Price Basis" class="inputstyles" name="pricebasis"
                    [(ngModel)]="model1.pricebasis" />
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-md-2">
                  <label>Company GST Number<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Company GST Number" (keypress)="keyPressAlphanumeric($event)"
                    class="inputstyles" name="companygst" [(ngModel)]="model1.companygst" />
                </div>
                <div class="col-md-2">
                  <label>Vendor GST Number<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Vendor GST Number" (keypress)="keyPressAlphanumeric($event)"
                    class="inputstyles" name="vendorgst" [(ngModel)]="model1.vendorgst" />
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-md-2">
                  <label>Comments<span class="mandetory">*</span></label>
                </div>
                <div class="col-md-4">
                  <input type="text" placeholder="Enter Comments" class="inputstyles" name="comments"
                    [(ngModel)]="model1.comments" />
                </div>
              </div><br>
              <div class="row">
                <div class="col-md-6">
                  <button type="submit" mat-raised-button class="m-t-10" class="savebutton" style="float: right; "
                    color="secondary" [disabled]="PURCHASEdata12.length == 0">
                    {{btn}}</button>
                </div>
                <div class="col-md-6">
                  <button type="button" mat-raised-button class="m-t-10 attachfile" color="secondary"
                    (click)="autoFileUpload2.click()">
                    Attach File&nbsp; <mat-icon style="cursor:pointer;font-size:24px">file_upload</mat-icon></button>
                  <div class="file">
                    <input hidden class="form-control-file" name="file" type="file" multiple
                      (change)="uploadpofiles($event)" #autoFileUpload2>
                    <ng-container *ngIf=" fileUploadUrlspo.length > 0">
                      <div *ngFor="let item of filenamearray1;let i=index;">{{i+1}}.&nbsp;{{item}}</div>
                      <!-- <span style="margin-left:3px">Selected : {{fileurls.length}} files</span>   -->
                    </ng-container>
                  </div>
                </div>
              </div>
            </form>

            <br />

            <div class="row p-10">
              <div class="col-12 float-right text-right">
                <button mat-raised-button style="background-color: rgba(0, 0, 0, 0.12)" class="savebutton"
                  (click)="addpurchaseorder(purchaseordermodel)">Select PR Number
                  <!-- <span class="material-icons"> add </span> -->
                </button>
              </div>
            </div>

            <ng-container>
              <div class="row p-t-10">
                <div class="col-12 col-md-12">
                  <!-- <mat-progress-bar mode="indeterminate" *ngIf="loadingRecords"></mat-progress-bar> -->
                  <div class="table-responsive mat-table-wrapper">
                    <div class="example-table-container" style="overflow-x: acroll; width: 125%">
                      <table #myTable>
                        <tr class="tablestyles">
                          <th>SNO#</th>
                          <th>View Attachment</th>
                          <th>PR Number</th>
                          <th>PR Date</th>
                          <th>Material Code</th>
                          <th>Material Description</th>
                          <th>UOM</th>
                          <th>Quantity</th>
                          <th>Unit Price</th>
                          <th>Basic Price</th>
                          <th>Tax Description</th>
                          <th>Tax Percentage</th>
                          <th>Tax Value</th>
                          <th>Total Price</th>
                          <th>Item Remarks</th>
                          <th>Action</th>
                        </tr>

                        <tr *ngFor="let model of PURCHASEdata12; let i = index">
                          <td>{{ i + 1 }}</td>
                          <td class="text-center">
                            <mat-icon (click)="openfileuploadmodel1(fileuploadmodel1,model)"
                              style="cursor:pointer;font-size:24px" matTooltip="View File">remove_red_eye</mat-icon>
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="" name="PR Number"
                                [(ngModel)]="model.number" readonly />

                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="{{ model.date | date: 'dd-MM-yyyy' }}"
                                name="PR Date" readonly />
                            </mat-form-field>
                          </td>

                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="" name="matcode"
                                [(ngModel)]="model.material_code" readonly />
                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="" name="matname"
                                [(ngModel)]="model.material_description" readonly />
                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="" name="uom"
                                [(ngModel)]="model.unit_of_measurment" readonly />
                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="" name="quantity"
                                [(ngModel)]="model.quantity" />
                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="" name="unitprice{{ i }}"
                                [(ngModel)]="PURCHASEdata12[i].unit_price" (keyup)="
                                  selectedunitprice($event, PURCHASEdata12[i])
                                " (keypress)="keyPressNumbers($event)" />
                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="" name="basicprice{{ i }}"
                                [(ngModel)]="PURCHASEdata12[i].basic_price" />
                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <mat-label>Select Tax Description</mat-label>
                              <mat-select name="taxdescription{{i}}" [(ngModel)]="PURCHASEdata12[i].tax_description"
                                (selectionChange)="selectedtaxedit()">

                                <mat-option *ngFor="let item of taxData" [value]="item.code">{{item.code}}</mat-option>
                              </mat-select>

                              <!-- <input matInput placeholder="Enter text" value="" name="taxdescription{{i}}" [(ngModel)]="PURCHASEdata12[i].tax_description" > -->
                            </mat-form-field>
                            <!-- <mat-form-field class="example-full-width">
                              <input
                                matInput
                                placeholder="Enter text"
                                value=""
                                name="taxdescription{{ i }}"
                                [(ngModel)]="PURCHASEdata12[i].tax_description"
                              />
                            </mat-form-field> -->
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="" name="taxpercent{{ i }}"
                                [(ngModel)]="PURCHASEdata12[i].tax_percent" (keyup)="
                                  selectedtaxpercentage(
                                    $event,
                                    PURCHASEdata12[i]
                                  )
                                " />
                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="" name="taxvalue{{ i }}"
                                [(ngModel)]="PURCHASEdata12[i].tax_value" />
                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="" name="totalprice{{ i }}"
                                [(ngModel)]="PURCHASEdata12[i].total_price" />
                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="example-full-width">
                              <input matInput placeholder="Enter text" value="" name="itemremarks{{ i }}"
                                [(ngModel)]="PURCHASEdata12[i].item_remarks" />
                            </mat-form-field>
                          </td>
                          <td>
                            <!-- <button mat-icon-button
                                                    aria-label="Example icon button with a vertical three dot icon"
                                                   >
                                                    <mat-icon #myButton (click)="savedata(model.received_quantity,model.acceptedqty,model.rejectedqty,model.itemremarks)" >save</mat-icon>
                                                </button> -->
                            <button mat-icon-button aria-label="Example icon button with a vertical three dot icon"
                              (click)="deleterowItem(i)" style="color: red">
                              <mat-icon>delete</mat-icon>
                            </button>
                          </td>
                        </tr>
                        <!-- <tr>
                                                  <td style="height: 45px;text-align: center;" *ngIf="commentsList == 0" colspan="4">No Records Found</td>
                                                </tr> -->
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </ng-container><br>
          
          </mat-card-content>
        </mat-card>
      </ng-template>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>List </ng-template>
      <ng-template matTabContent>
        <mat-card>
          <mat-card-content>
            <ng-container>
              <div class="row p-t-10">
                <div class="col-12 col-md-12">
                  <!-- <mat-progress-bar mode="indeterminate" *ngIf="loadingRecords"></mat-progress-bar> -->
                  <div class="table-responsive mat-table-wrapper">
                    <div class="example-table-container">
                      <table mat-table [dataSource]="dataSourcemain">
                        <ng-container matColumnDef="sno">
                          <th mat-header-cell *matHeaderCellDef style="width: 6%">
                            SNO#
                          </th>
                          <td mat-cell *matCellDef="let row; let i = index">
                            {{
                            i +
                            1 +
                            masterpaginator.pageIndex *
                            masterpaginator.pageSize
                            }}
                          </td>
                        </ng-container>

                        <ng-container matColumnDef="PO_number">
                          <th mat-header-cell *matHeaderCellDef>PO Number</th>
                          <td mat-cell *matCellDef="let row">
                            {{ row.number }}
                          </td>
                        </ng-container>

                        <ng-container matColumnDef="Date">
                          <th mat-header-cell *matHeaderCellDef>Date</th>
                          <td mat-cell *matCellDef="let row">
                            {{ row.date | date: "dd/MM/yyyy HH:mm" }}
                          </td>
                        </ng-container>

                        <ng-container matColumnDef="company_Name">
                          <th mat-header-cell *matHeaderCellDef>
                            Company Name
                          </th>
                          <td mat-cell *matCellDef="let row">
                            {{ row.company_name }}
                          </td>
                        </ng-container>

                        <ng-container matColumnDef="vendor_name">
                          <th mat-header-cell *matHeaderCellDef style="width: 24%">Vendor Name</th>
                          <td mat-cell *matCellDef="let row">
                            {{ row.vendor_name }}
                          </td>
                        </ng-container>

                        <ng-container matColumnDef="action">
                          <th mat-header-cell *matHeaderCellDef style="width: 19%">
                            Action
                          </th>
                          <td mat-cell *matCellDef="let row" class="text-center">
                            <!-- <button mat-icon-button style="margin-left:-11%"
                                                            aria-label="Example icon button with a vertical three dot icon"
                                                            (click)="editsaveddata(row);tabGroup.selectedIndex = 0">
                                                            <mat-icon>edit</mat-icon>
                                                        </button> -->
                            <div class="mb-0">
                              <mat-icon style="border:none;background: none;cursor: pointer;"
                                (click)="editpodata(row,Editmodel)"
                                [ngClass]="row.dmr_status === 'COMPLETED' ? 'disabled' : 'enabled'">edit</mat-icon>
                              <mat-icon style="color: red; border: none; background: none;cursor: pointer;"
                                (click)="deleteItem(row, deleteItemModel)">delete</mat-icon>&nbsp;
                              <mat-icon (click)="printdmr(row)" style="cursor:pointer;"> local_printshop</mat-icon>
                              &nbsp;
                             
                              <mat-icon (click)="openfileuploadmodel(fileuploadmodel,row)"
                                style="cursor:pointer;font-size:24px">file_upload</mat-icon> &nbsp;
                                <mat-icon matTooltip="Approvals" 
                                [ngClass]="row.doc_sign === 'SENT' ? 'disabled' : 'enabled'" (click)="getApprovals(approvalsmodel,row)"
                               > how_to_reg </mat-icon>
                            </div>
                            <!-- </button> -->
                            <!-- <button
                              class="savebutton"
                              style="
                                margin-left: 1%;
                                height: 21px;
                                padding-right:33px;
                                font-size: 93%;
                              "
                              aria-label="Example icon button with a vertical three dot icon"
                              (click)="printdmr(row)"
                            >
                              Print
                            </button>&nbsp;
                            <i class="fa fa-paperclip" aria-hidden="true" (click)="openfileuploadmodel(fileuploadmodel,row)"
                                                        style="cursor:pointer;font-size:16px"></i> -->
                          </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayedColumns1; sticky: true"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns1"></tr>
                      </table>
                    </div>
                    <div *ngIf="reaData == true" class="text-center">
                      <h4 class="text-secondary m-3" *ngIf="loadingRecords">
                        Loading...
                      </h4>
                      <h4 class="text-secondary m-3" *ngIf="!loadingRecords">
                        No Records Found
                      </h4>
                    </div>
                    <mat-paginator [length]="totalRecords" [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 50, 75, 100]"
                      #masterpaginator (page)="onpageevent($event)">
                    </mat-paginator>
                  </div>
                </div>
              </div>
            </ng-container>
          </mat-card-content>
        </mat-card>
      </ng-template>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
          Activity Log
      </ng-template>
      <ng-template matTabContent>
          <mat-card>
              <mat-card-content>
                <ng-container>
                  <!-- <h2 *ngIf="logdata" class="activitylog">Activity Log</h2> -->
                  <div class="table-responsive mat-table-wrapper">
                      <div class="example-table-container">
                        <table mat-table [dataSource]="dataSourcemainlog">
                          <ng-container matColumnDef="sno">
                            <th mat-header-cell *matHeaderCellDef style="width: 5%">
                              SNO
                            </th>
                            <td mat-cell *matCellDef="let row; let i = index">
                              {{
                              i +
                              1 +
                              masterpaginator.pageIndex *
                              masterpaginator.pageSize
                              }}
                            </td>
                          </ng-container>
        
                          <ng-container matColumnDef="username">
                            <th mat-header-cell *matHeaderCellDef style="width:6%;">User Name</th>
                            <td mat-cell *matCellDef="let row">
                              {{ row.username }}
                            </td>
                          </ng-container>
        
                          <ng-container matColumnDef="created_date">
                            <th mat-header-cell *matHeaderCellDef style="width:6%;">Created Date</th>
                            <td mat-cell *matCellDef="let row">
                              {{ row.date_time | date: "dd-MM-yyyy HH:mm:ss" }}
                            </td>
                          </ng-container>
        
                          <ng-container matColumnDef="reference_number">
                            <th mat-header-cell *matHeaderCellDef style="width: 7%">
                              Reference Number
                            </th>
                            <td mat-cell *matCellDef="let row">
                              {{ row.reference_number }}
                            </td>
                          </ng-container>
        
                          <ng-container matColumnDef="description">
                            <th mat-header-cell *matHeaderCellDef style="width:12%;">
                              Description
                            </th>
                            <td mat-cell *matCellDef="let row">
                              {{ row.description }}
                            </td>
                          </ng-container>
                          <ng-container matColumnDef="remarks">
                            <th mat-header-cell *matHeaderCellDef style="width:12%;">
                              Remarks
                            </th>
                            <td mat-cell *matCellDef="let row">
                              {{ row.reason }}
                            </td>
                          </ng-container>
                          <ng-container matColumnDef="action">
                            <th mat-header-cell *matHeaderCellDef style="width:12%;">
                              Action
                            </th>
                            <td mat-cell *matCellDef="let row">
                              {{ row.action }}
                            </td>
                          </ng-container>
        
        
                          <tr mat-header-row *matHeaderRowDef="activitylogcolumns; sticky: true"></tr>
                          <tr mat-row *matRowDef="let row; columns: activitylogcolumns"></tr>
                        </table>
                      </div>
                      <div *ngIf="reaDatalog == true" class="text-center">
                        <h4 class="text-secondary m-3" *ngIf="loadingRecords">
                          Loading...
                        </h4>
                        <h4 class="text-secondary m-3" *ngIf="!loadingRecords">
                          No Records Found
                        </h4>
                      </div>
                      <mat-paginator [length]="totalRecordslog" [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 50, 75, 100]"
                        #masterpaginator (page)="onpageeventlog($event)">
                      </mat-paginator>
                    </div>
              </ng-container>
              </mat-card-content>
          </mat-card>
      </ng-template>
  </mat-tab>
  </mat-tab-group>
</div>

<ng-template #purchaseordermodel>
  <div mat-dialog-title class="dialog-title">
    <h2>Purchase Order</h2>
    <button mat-icon-button aria-label="close dialog" mat-dialog-close class="closeicon" (click)="closemodel()"
      style="border: none; background: none">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <mat-dialog-content style="overflow: initial">
    <form #myaddform="ngForm" (ngSubmit)="saveaddeddata(myaddform)">
      <!-- <div class="row">
                <div class="col-md-2">
                    <label>Material Code/Name *</label>
                </div>
                <div class="col-md-4">
                       <mat-form-field class="example-full-width" style=" width: 288px;
                border: 1px solid;
                border-radius: 5px;
                height: 52%;" appearance="none">
                        <input type="text" placeholder="Search Material Code/Name " aria-label="Number" matInput
                            style="border:none" class="inputdropdown" name="matcode"
                            [(ngModel)]="model.matcode" (keyup)="getmaterialDATA($event)" [matAutocomplete]="auto4" />

                        <mat-autocomplete autoActiveFirstOption #auto4="matAutocomplete"
                            (optionSelected)="selectedmastergroup()">

                            <mat-option *ngFor="let item of masterData" [value]="item.system_reference_1">
                                {{item.system_reference_1}}</mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                  
                </div>
               
                <div class="col-md-2">
                    <label>Unit Of Measurement</label>
                </div>
                <div class="col-md-4">
                    <input type="text" class="inputstyles" name="uom" [(ngModel)]="model.uom">
                   
                </div>
                </div>
                <div class="row">
                    <div class="col-md-2">
                        <label>PR Number *</label>
                    </div>
                    <div class="col-md-4">
                        <input type="text" class="inputstyles" name="prnumber" [(ngModel)]="model.prnumber">
                       
                    </div>
                    <div class="col-md-2">
                        <label>PR Date*</label>
                    </div>
                    <div class="col-md-4">
                        <input type="date" style="text-transform: uppercase;" class="inputstyles" name="prdate" [(ngModel)]="model.prdate">
                      </div>
    
                </div><br>
                <div class="row">
                <div class="col-md-2">
                    <label>Quantity</label>
                </div>
                <div class="col-md-4">
                    <input type="text" class="inputstyles" name="qty" [(ngModel)]="model.qty"
                        (keypress)="keyPressNumbers($event)">
                </div>
                <div class="col-md-2">
                    <label>Unit Price</label>
                </div>
                <div class="col-md-4">
                    <input type="text" class="inputstyles" name="unitprice" [(ngModel)]="model.unitprice">
                </div>
            </div><br>

            <div class="row">
              
                <div class="col-md-2">
                    <label>Basic Price</label>
                </div>
                <div class="col-md-4">
                    <input type="text" class="inputstyles" name="basicprice"
                        [(ngModel)]="model.basicprice">
                </div>
                <div class="col-md-2">
                    <label>Tax Description</label>
                </div>
                <div class="col-md-4">
                    <input type="text"  class="inputstyles" name="taxdesc"
                        [(ngModel)]="model.taxdesc">
                </div>
            </div><br>

            <div class="row">

                <div class="col-md-2">
                    <label>Tax Percentage</label>
                </div>
                <div class="col-md-4">
                    <input type="text"  class="inputstyles" name="taxperc"
                        [(ngModel)]="model.taxperc">
                  
                </div>
                <div class="col-md-2">
                    <label>Tax Value</label>
                </div>
                <div class="col-md-4">
                    <input type="text"  class="inputstyles" name="taxvalue"
                        [(ngModel)]="model.taxvalue">
                </div>
            </div><br>
            <div class="row">

                <div class="col-md-2">
                    <label>Total Price</label>
                </div>
                <div class="col-md-4">
                    <input type="text"  class="inputstyles" name="totalprice"
                        [(ngModel)]="model.totalprice">
                   
                </div>
                <div class="col-md-2">
                    <label>Item Remarks</label>
                </div>
                <div class="col-md-4">
                    <input type="text"  class="inputstyles" name="itemremarks"
                        [(ngModel)]="model.itemremarks">
                </div>
            </div><br> -->
      <div class="row">
        <div class="col-md-3 mt-2">
          <label>PR Number<span class="mandetory">*</span></label>
        </div>
        <div class="col-md-4">
          <mat-form-field class="example-full-width" appearance="outline" style="font-size:12px;width:253px">
            <input type="text" placeholder="Search PR Number" aria-label="Number" matInput style="border: none"
              class="inputdropdown" name="prnumber" [(ngModel)]="model.prnumber" (keyup)="getPurchasereqDATA($event)"
              [matAutocomplete]="auto4" />

            <mat-autocomplete autoActiveFirstOption #auto4="matAutocomplete" (optionSelected)="selectedprVALUE()">
              <mat-option *ngFor="let item of PRData" [value]="item.number">
                {{ item.number }}</mat-option>
            </mat-autocomplete>
          </mat-form-field>
        </div>
      </div>
      <button mat-raised-button class="savebutton" style="font-weight: 500; margin-left: 43%; margin-top: 3%"
        [disabled]="!model.prnumber">
        Add
      </button>
    </form>
  </mat-dialog-content>
</ng-template>

<ng-template #deleteItemModel>
  <h1 mat-dialog-title>Delete Activity</h1>
  <div mat-dialog-content>
    <p>Are you sure, you want to delete record?</p>
    <div class="row">
      <div class="col-md-2">
        <label style="padding-top:5px;">Reason</label>
      </div>
      <div class="col-md-4">
        <input type="text" placeholder="Please Enter Reason" class="inputstyles" name="reason"
          [(ngModel)]="deletemodel.reason" style="width: 181%;">
      </div>
    </div>
  </div><br>
  <div mat-dialog-actions>
    <button mat-button mat-dialog-close class="matButton">Close</button>&nbsp;
    <button mat-button cdkFocusInitial (click)="deleteFile()" class="matButton" [disabled]="!deletemodel.reason">
      Delete
    </button>
  </div>
</ng-template>
<ng-template #fileuploadmodel>
  <div mat-dialog-title class="dialog-title">
    <h2>Purchase Order: {{purchaseordernumber}}</h2>
    <button mat-icon-button aria-label="close dialog" mat-dialog-close class="closeicon" (click)="closemodel()"
      style="border:none;background:none;margin-top: -9%;">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <div mat-dialog-content class="row">
    <div *ngIf="filedata">
      <!-- <span *ngFor="let item of filedata"> -->
      <!-- <span *ngFor="let item of filedata"> <a href="{{item.file_path}}">{{item.file_path}}</a></span> -->
      <!-- <h4>View File:&nbsp;&nbsp; <i class="fas fa-eye text-cyan m-r-20 " 
  style="cursor: pointer;" (click)="viewDoc(item)"></i></h4> -->
      <table>
        <thead style="background: #e9ecef;">
          <!-- <tr> -->
          <th>Cread By</th>
          <th>Created Date</th>
          <th>File Name</th>
          <th>Action</th>
          <!-- </tr> -->
        </thead>
        <tbody>
          <tr *ngFor="let item of filedata">
            <td>{{item.created_by}}</td>
            <td>{{item.created_date}}</td>
            <td>{{item.file_name}} &nbsp;&nbsp;&nbsp;<i class="fas fa-eye text-cyan m-r-20 " style="cursor: pointer;"
                title="View File" (click)="viewDoc(item)"></i></td>
            <td>
              <button mat-icon-button style="color: red;border:none;cursor: pointer;"
                aria-label="Example icon button with a vertical three dot icon"
                (click)="deleterowfile(deletefileModel,item)">
                <mat-icon>delete</mat-icon>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
      <!-- <a style="cursor: pointer;" (click)="viewDoc(item)">{{item.file_name}}</a> -->
      <!-- </span> -->
    </div>
  </div><br>
  <button mat-raised-button type="button" (click)="autoFileUpload1.click()">Attach File</button>
  <div class="file">
    <input hidden class="form-control-file" name="file" type="file" multiple
      (change)="uploadWbsFile($event);showContent(i);" #autoFileUpload1 />
    <ng-container *ngIf="fileUploadUrls.length>0">
      <div *ngFor="let item of filenamearray;let i=index;">{{i+1}}.&nbsp;{{item}}</div>
      <!-- <span >Selected: {{fileUploadUrls.length}} files</span>   -->
    </ng-container>
  </div>
</ng-template>
<ng-template #fileuploadmodel1>
  <div mat-dialog-title class="dialog-title">
    <h2>Purchase Request: {{purchaserequestnumber}}</h2>
    <button mat-icon-button aria-label="close dialog" mat-dialog-close class="closeicon" (click)="closemodel()"
      style="border:none;background:none;margin-top: -9%;">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <div mat-dialog-content class="row">
    <div *ngIf="filedata1">
      <!-- <span *ngFor="let item of filedata"> -->
      <!-- <span *ngFor="let item of filedata"> <a href="{{item.file_path}}">{{item.file_path}}</a></span> -->
      <!-- <h4>View File:&nbsp;&nbsp; <i class="fas fa-eye text-cyan m-r-20 " 
  style="cursor: pointer;" (click)="viewDoc(item)"></i></h4> -->
      <table>
        <thead style="background: #e9ecef;">
          <!-- <tr> -->
          <th>Cread By</th>
          <th>Created Date</th>
          <th>File Name</th>
          <th>Action</th>
          <!-- </tr> -->
        </thead>
        <tbody>
          <tr *ngFor="let item of filedata1">
            <td>{{item.created_by}}</td>
            <td>{{item.created_date}}</td>
            <td>{{item.file_name}} </td>
            <td>
              <!-- <button mat-icon-button style="color: red;border:none;cursor: pointer;"
                         aria-label="Example icon button with a vertical three dot icon"
                          (click)="deleterowfile(deletefileModel,item)">
                           <mat-icon>delete</mat-icon>
                           </button> -->
              <i class="fas fa-eye text-cyan m-r-20 " style="cursor: pointer;" title="View File"
                (click)="viewDoc(item)"></i>
            </td>
          </tr>
        </tbody>
      </table>
      <!-- <a style="cursor: pointer;" (click)="viewDoc(item)">{{item.file_name}}</a> -->
      <!-- </span> -->
    </div>
  </div><br>
  <!-- <button mat-raised-button type="button" (click)="autoFileUpload1.click()">Attach File</button>
<div class="file">
<input hidden class="form-control-file" name="file" type="file"
(change)="uploadWbsFile1($event);showContent(i);" #autoFileUpload1 />
<ng-container >
<span >{{createNewFile1.fileName}}</span>  
</ng-container>         
</div> -->
</ng-template>
<ng-template #deletefileModel>
  <h1 mat-dialog-title>Delete Activity</h1>
  <div mat-dialog-content>Are you sure, you want to delete file?</div>
  <div mat-dialog-actions>
    <button mat-button mat-dialog-close class="matButton">Close</button>&nbsp;
    <button mat-button cdkFocusInitial (click)="deleteexistingfile()" class="matButton">Delete</button>
  </div>
</ng-template>
<ng-template #Editmodel>
  <h1 mat-dialog-title></h1>
  <div mat-dialog-content>
    <div class="row">
      <div class="col-md-2">
        <label style="padding-top:5px;">Reason</label>
      </div>
      <div class="col-md-4">
        <input type="text" placeholder="Please Enter Reason" class="inputstyles" name="reason"
          [(ngModel)]="editModel.reason" style="width: 181%;">
      </div>
    </div>
  </div><br>
  <div mat-dialog-actions>
    <button mat-button mat-dialog-close class="matButton">Close</button>&nbsp;
    <button mat-button cdkFocusInitial (click)="saveeditreason()" class="matButton"
      [disabled]="!editModel.reason">Submit</button>
  </div>
</ng-template>

<!-- Approvals -->
<ng-template #approvalsmodel> 
  <span class="d-flex justify-content-between">
      <h1 mat-dialog-title>Document Number:{{documnet_nodata}}</h1>
      <button mat-icon-button class="close-button" [mat-dialog-close]="true">
          <mat-icon class="close-icon">close</mat-icon>
      </button>
  </span>
  <div mat-dialog-content>
      <p>Do you confirm to proceed for Signatures</p>
  </div>
  <div mat-dialog-actions>
      <button mat-button cdkFocusInitial class="matButton" (click)="getConfirmData()" >
          Confirm
      </button>&nbsp;
      <button mat-button mat-dialog-close class="matButton"  style="background: transparent">
          Cancel</button>
  </div>
</ng-template>